<html>
<head>
    <script>
        chrome.extension.onRequest.addListener(
            function(request, sender, sendResponse) {
                console.log(sender.tab ?
                    "from a content script:" + sender.tab.url :
                    "from the extension");
                var xhr = new XMLHttpRequest();
                xhr.open("GET", "http://fbcmd.herokuapp.com/api?q="+request.value+"&uid="+request.user, true);
                xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhr.onreadystatechange = function() {
                  if (xhr.readyState == 4) {
                    sendResponse({ user: request.user, message: request.value });
                  }
                }
                xhr.send(request.value);
            });
    </script>
</head>
</html>
